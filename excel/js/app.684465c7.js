(function(t){function e(e){for(var s,l,a=e[0],r=e[1],c=e[2],h=0,f=[];h<a.length;h++)l=a[h],Object.prototype.hasOwnProperty.call(i,l)&&i[l]&&f.push(i[l][0]),i[l]=0;for(s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s]);u&&u(e);while(f.length)f.shift()();return o.push.apply(o,c||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],s=!0,a=1;a<n.length;a++){var r=n[a];0!==i[r]&&(s=!1)}s&&(o.splice(e--,1),t=l(l.s=n[0]))}return t}var s={},i={app:0},o=[];function l(e){if(s[e])return s[e].exports;var n=s[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,l),n.l=!0,n.exports}l.m=t,l.c=s,l.d=function(t,e,n){l.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},l.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.t=function(t,e){if(1&e&&(t=l(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(l.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)l.d(n,s,function(e){return t[e]}.bind(null,s));return n},l.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return l.d(e,"a",e),e},l.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},l.p="";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],r=a.push.bind(a);a.push=e,a=a.slice();for(var c=0;c<a.length;c++)e(a[c]);var u=r;o.push([1,"chunk-vendors"]),n()})({0:function(t,e){},1:function(t,e,n){t.exports=n("56d7")},2:function(t,e){},3:function(t,e){},3101:function(t,e,n){"use strict";n("6a11")},"56d7":function(t,e,n){"use strict";n.r(e);var s=n("8642"),i=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},o=[],l={name:"App"},a=l,r=(n("cfd3"),n("0b56")),c=Object(r["a"])(a,i,o,!1,null,null,null),u=c.exports,h=n("1ceb"),f=function(){var t=this,e=t._self._c;return e("div",{staticClass:"x-home"},[e("el-upload",{staticClass:"upload-demo",attrs:{multiple:"",action:"","on-change":t.uploadAction,"auto-upload":!1,"file-list":t.fileList}},[e("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")])],1),e("el-divider",{attrs:{"content-position":"left"}},[t._v("操作表格")]),e("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.previewTables("preview")}}},[t._v("预览表格")]),e("el-input-number",{staticStyle:{margin:"0 20px"},attrs:{label:"按第几列分组",size:"small"},model:{value:t.num,callback:function(e){t.num=e},expression:"num"}}),e("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.exportTable("one")}}},[t._v("导出一个表格")]),e("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.exportTable("more")}}},[t._v("导出多个表格")]),e("el-divider",{attrs:{"content-position":"center"}},[t._v("😺")]),"preview"===t.index?e("div",{staticStyle:{width:"100%",height:"400px",overflow:"auto"}},t._l(t.tables,(function(n,s){return e("div",{key:"table-"+s,staticStyle:{width:"100%","margin-right":"8px",float:"left"}},[e("p",{staticStyle:{"font-size":"12px"}},[t._v(t._s(n.title))]),e("el-table",{attrs:{data:n.list,border:"",stripe:"",size:"small"}},t._l(n.cols,(function(t,n){return e("el-table-column",{key:"x-"+n,attrs:{fixed:0===n,prop:t.id,label:t.name}})})),1)],1)})),0):"new"===t.index?e("div",{staticStyle:{width:"100%",height:"400px",overflow:"auto"}},[e("div",{staticStyle:{width:"100%","margin-right":"8px",float:"left"}},[e("p",{staticStyle:{"font-size":"12px"}},[t._v(t._s(t.result.title))]),e("el-table",{attrs:{data:t.result.list,border:"",stripe:"",size:"small"}},t._l(t.result.cols,(function(t,n){return e("el-table-column",{key:"x-"+n,attrs:{prop:t.id,label:t.name}})})),1)],1)]):t._e()],1)},p=[],d=n("c886"),g=n.n(d),m={name:"Home",props:{item:{type:Object,default:function(){return{}}}},data(){return{tables:[],result:{title:"合并后的表格",list:[],cols:[]},fileList:[],index:"xxx",num:4}},methods:{previewTables:function(t){this.index=t,this.tables=[];for(let e=0;e<this.fileList.length;e++){const t=this.fileList[e],n={title:t.name,list:[],cols:[]};this.tables.push(n),this.processFile(t,n)}},createTable:function(t){this.index=t,this.fileList.length<3&&alert("应该是三个表格");for(let e=0;e<this.tables[2].list.length;e++){const t=this.tables[2].list[e];let n=null,s=null;for(let e=0;e<this.tables[1].list.length;e++){const s=this.tables[1].list[e],i=Object.keys(s);for(let e=0;e<i.length;e++){const o=i[e];s[o]+""===t.column0+""&&(n=s)}}for(let e=0;e<this.tables[0].list.length;e++){const n=this.tables[0].list[e],i=Object.keys(n);for(let e=0;e<i.length;e++){const o=i[e];n[o]+""===t.column2+""&&(s=n)}}t&&n&&s?console.log(t,n,s):console.log("不合法")}},exportTable:function(t="one"){const e=this.tables[0].list,n={};for(let o=0;o<this.tables[0].cols.length;o++){const t=this.tables[0].cols[o];n[t.id]=t.name}const s=[],i="column"+(this.num-1);for(let o=0;o<e.length;o++){const t=e[o],l=s.find(e=>e.name===t[i]);if(l)console.log("已存在",t[i]);else{const o={name:t[i],list:e.filter(e=>e[i]===t[i])};o.list.unshift(n),s.push(o)}}if("one"===t){const t=g.a.utils.book_new();for(let e=0;e<s.length;e++){const n=s[e];if(n.list.length){console.log("组:",e,n.name);const s=n.list[0],i=Object.keys(s),o=g.a.utils.json_to_sheet(n.list,{skipHeader:!0});o["!cols"]=[];for(let t=0;t<i.length;t++){const e=i[t];s[e]?o["!cols"].push({wch:2*(s[e]+"").length+10}):o["!cols"].push({wch:10})}g.a.utils.book_append_sheet(t,o,n.name)}}g.a.writeFile(t,"分组后.xlsx")}else for(let o=0;o<s.length;o++){const t=s[o];if(t.list.length){console.log("组:",o,t.name);const e=g.a.utils.book_new(),n=t.list[0],s=Object.keys(n),i=g.a.utils.json_to_sheet(t.list,{skipHeader:!0});i["!cols"]=[];for(let t=0;t<s.length;t++){const e=s[t];n[e]?i["!cols"].push({wch:2*(n[e]+"").length+10}):i["!cols"].push({wch:10})}g.a.utils.book_append_sheet(e,i,t.name),g.a.writeFile(e,t.name+".xlsx")}}},getGroups:function(t,e){var n={};t.forEach(t=>{if(n[t[e]])n[t[e]].list.push(t);else{const s={list:[t]};s[e]=t[e],n[t[e]]=s}});const s=[];for(var i in n)s.push(n[i]);return s},uploadAction:function(t,e){console.log(t,e),this.fileList.push(t)},processFile(t,e){const n=new FileReader;n.onload=t=>{const n=t.target.result,s=g.a.read(n,{type:"binary"}),i=s.SheetNames[0],o=s.Sheets[i];e.cols=this.getHeaderRow(o),e.list=[];const l=g.a.utils.sheet_to_json(o,{header:1});for(let a=1;a<l.length;a++){const t=l[a],n={};for(let e=0;e<t.length;e++)n["column"+e]=t[e]?t[e]+"":"";e.list.push(n)}},n.readAsBinaryString(t.raw)},getHeaderRow:function(t){const e=[],n=g.a.utils.decode_range(t["!ref"]);let s;const i=n.s.r;for(s=n.s.c;s<=n.e.c;++s){const n=t[g.a.utils.encode_cell({c:s,r:i})];let o="UNKNOWN "+s;n&&n.t&&(o=g.a.utils.format_cell(n)),console.log(s);const l={id:"column"+s,name:o};e.push(l)}return e}}},b=m,v=(n("d6f6"),Object(r["a"])(b,f,p,!1,null,"34df3c46",null)),y=v.exports,_=function(){var t=this,e=t._self._c;return e("div",{staticClass:"xx-Test"},[t._m(0),e("button",{on:{click:function(e){t.scale=t.scale+.2}}},[t._v("放大")]),e("button",{on:{click:function(e){t.scale=t.scale-.2}}},[t._v("缩小")]),e("button",{on:{click:function(e){t.offsetY=t.offsetY-20}}},[t._v("上移")]),e("button",{on:{click:function(e){t.offsetY=t.offsetY+20}}},[t._v("下移")]),e("button",{on:{click:function(e){t.offsetX=t.offsetX-20}}},[t._v("左移")]),e("button",{on:{click:function(e){t.offsetX=t.offsetX+20}}},[t._v("右移")]),e("button",{on:{click:function(e){t.deg=t.deg+90}}},[t._v("旋转")])])},w=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"parent"},[e("div",{staticClass:"son"})])}];n("9b2a");class x{constructor({ele:t,src:e,angle:n}){this.ele=t,this.image=new Image,this.image.setAttribute("crossOrigin","anonymous"),this.image.src=e,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.angle=n}async rotate(){const t=new Image,e=[0,90,180,270];return this.image.onload=n=>{switch(e[this.angle]%180===0?(this.canvas.width=this.image.width,this.canvas.height=this.image.height):(this.canvas.width=this.image.height,this.canvas.height=this.image.width),this.angle){case 0:this.ctx.translate(0,0);break;case 1:this.ctx.translate(this.canvas.width,0);break;case 2:this.ctx.translate(this.canvas.width,this.canvas.height);break;case 3:this.ctx.translate(0,this.canvas.height);break;default:throw new ReferenceError("No angle")}this.ctx.rotate(e[this.angle]*Math.PI/180),this.ctx.drawImage(this.image,0,0,this.image.width,this.image.height,0,0,this.image.width,this.image.height),t.src=this.canvas.toDataURL("image/png"),this.isDom()&&this.ele.appendChild(t)},t}isDom(){return"object"===typeof this.ele&&1===this.ele.nodeType&&"string"===typeof this.ele.nodeName}}var k=x,j={name:"Test",props:{item:{type:Object,default:function(){return{}}}},data(){return{offsetX:0,offsetY:0,deg:0,scale:1}},computed:{stylex:function(){return`transform: translate(${this.offsetX}px,${this.offsetY}px) rotate(${this.deg}deg) scale(${this.scale});`}},mounted(){this.xuanzhuan()},methods:{xuanzhuan:function(t=1){new k({src:"./IMG_20211102_154941.jpg",angle:t}).rotate().then(t=>{console.log(t),t.setAttribute("draggable","false"),document.body.querySelector(".son").innerHTML="",document.body.querySelector(".son").appendChild(t)})}}},O=j,S=(n("3101"),Object(r["a"])(O,_,w,!1,null,"307c0d00",null)),T=S.exports;s["default"].use(h["a"]);const z=new h["a"]({routes:[{path:"/",name:"Home",component:y},{path:"/test",name:"Test",component:T}]});var C=z,L=n("63b8"),P=n.n(L);n("1c2f");s["default"].use(P.a),s["default"].config.productionTip=!1,new s["default"]({router:C,render:t=>t(u)}).$mount("#app")},5938:function(t,e,n){},"6a11":function(t,e,n){},b6a0:function(t,e,n){},cfd3:function(t,e,n){"use strict";n("5938")},d6f6:function(t,e,n){"use strict";n("b6a0")}});
//# sourceMappingURL=app.684465c7.js.map