(function(t){function e(e){for(var l,o,r=e[0],a=e[1],c=e[2],f=0,h=[];f<r.length;f++)o=r[f],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&h.push(s[o][0]),s[o]=0;for(l in a)Object.prototype.hasOwnProperty.call(a,l)&&(t[l]=a[l]);u&&u(e);while(h.length)h.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],l=!0,r=1;r<n.length;r++){var a=n[r];0!==s[a]&&(l=!1)}l&&(i.splice(e--,1),t=o(o.s=n[0]))}return t}var l={},s={app:0},i=[];function o(e){if(l[e])return l[e].exports;var n=l[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=l,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var l in t)o.d(n,l,function(e){return t[e]}.bind(null,l));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],a=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var u=a;i.push([1,"chunk-vendors"]),n()})({0:function(t,e){},1:function(t,e,n){t.exports=n("56d7")},2:function(t,e){},3:function(t,e){},"56d7":function(t,e,n){"use strict";n.r(e);var l=n("f568"),s=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},i=[],o={name:"App"},r=o,a=(n("cfd3"),n("0b56")),c=Object(a["a"])(r,s,i,!1,null,null,null),u=c.exports,f=n("f038"),h=function(){var t=this,e=t._self._c;return e("div",{staticClass:"x-home"},[e("el-upload",{staticClass:"upload-demo",attrs:{multiple:"",action:"","on-change":t.uploadAction,"auto-upload":!1,"file-list":t.fileList}},[e("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")])],1),e("el-divider",{attrs:{"content-position":"left"}},[t._v("操作表格 - 按列分组")]),e("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.previewTables("preview")}}},[t._v("预览表格")]),e("el-input-number",{staticStyle:{margin:"0 20px"},attrs:{label:"按第几列分组",size:"small"},model:{value:t.num,callback:function(e){t.num=e},expression:"num"}}),e("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.exportTable("one")}}},[t._v("导出一个表格")]),e("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.exportTable("more")}}},[t._v("导出多个表格")]),e("el-divider",{attrs:{"content-position":"center"}},[t._v("author - wx: angewechat")]),"preview"===t.index?e("div",{staticStyle:{width:"100%"}},t._l(t.tables,(function(n,l){return e("div",{key:"table-"+l,staticStyle:{width:"100%","margin-right":"8px",float:"left"}},[n.list.length>0?[e("p",{staticStyle:{"font-size":"12px"}},[t._v("共"+t._s(n.list.length)+"条数据 - "+t._s(n.title))]),e("el-table",{attrs:{data:n.list,height:"600px",border:"",stripe:"",size:"small"}},[e("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),t._l(n.cols,(function(t,n){return e("el-table-column",{key:"x-"+n,attrs:{prop:t.id,label:t.name}})}))],2)]:e("p",[t._v("文件解析中...")])],2)})),0):"new"===t.index?e("div",{staticStyle:{width:"100%"}},[e("div",{staticStyle:{width:"100%","margin-right":"8px",float:"left"}},[e("p",{staticStyle:{"font-size":"12px"}},[t._v(t._s(t.result.title))]),e("el-table",{attrs:{data:t.result.list,border:"",stripe:"",size:"small",height:"600px"}},t._l(t.result.cols,(function(t,n){return e("el-table-column",{key:"x-"+n,attrs:{prop:t.id,label:t.name}})})),1)],1)]):t._e()],1)},p=[],d=(n("24b8"),n("b2f4"),n("c886")),m=n.n(d),b={name:"Home",props:{item:{type:Object,default:function(){return{}}}},data(){return{tables:[],result:{title:"合并后的表格",list:[],cols:[]},fileList:[],index:"xxx",num:8}},methods:{previewTables:function(t){this.index=t,this.tables=[];for(let e=0;e<this.fileList.length;e++){const t=this.fileList[e],n={title:t.name,list:[],cols:[]};this.tables.push(n),this.processFile(t,n)}},createTable:function(t){this.index=t,this.fileList.length<3&&alert("应该是三个表格");for(let e=0;e<this.tables[2].list.length;e++){const t=this.tables[2].list[e];let n=null,l=null;for(let e=0;e<this.tables[1].list.length;e++){const l=this.tables[1].list[e],s=Object.keys(l);for(let e=0;e<s.length;e++){const i=s[e];l[i]+""===t.column0+""&&(n=l)}}for(let e=0;e<this.tables[0].list.length;e++){const n=this.tables[0].list[e],s=Object.keys(n);for(let e=0;e<s.length;e++){const i=s[e];n[i]+""===t.column2+""&&(l=n)}}t&&n&&l?console.log(t,n,l):console.log("不合法")}},exportTable:function(t="one"){const e=this.tables[0].list,n={};for(let i=0;i<this.tables[0].cols.length;i++){const t=this.tables[0].cols[i];n[t.id]=t.name}const l=[],s="column"+(this.num-1);for(let i=0;i<e.length;i++){const t=e[i],o=l.find(e=>e.name===t[s]);if(o)console.log("已存在",t[s]);else{const i={name:t[s],list:e.filter(e=>e[s]===t[s])};i.list.unshift(n),l.push(i)}}if("one"===t){const t=m.a.utils.book_new();for(let e=0;e<l.length;e++){const n=l[e];if(n.list.length){console.log("组:",e,n.name);const l=n.list[0],s=Object.keys(l),i=m.a.utils.json_to_sheet(n.list,{skipHeader:!0});i["!cols"]=[];for(let t=0;t<s.length;t++){const e=s[t];l[e]?i["!cols"].push({wch:2*(l[e]+"").length+10}):i["!cols"].push({wch:10})}m.a.utils.book_append_sheet(t,i,n.name)}}m.a.writeFile(t,"分组后.xlsx")}else if(confirm("攀岩志提示: 一共将的导出"+l.length+"个表格, 下载大概需要用时"+1.5*l.length/60+"min，确定下载？"))for(let i=0;i<l.length;i++)setTimeout(function(t){return function(){const e=l[t];if(e.list.length){console.log("组:",t,e.name);const n=m.a.utils.book_new(),l=e.list[0],s=Object.keys(l),i=m.a.utils.json_to_sheet(e.list,{skipHeader:!0});i["!cols"]=[];for(let t=0;t<s.length;t++){const e=s[t];l[e]?i["!cols"].push({wch:2*(l[e]+"").length+10}):i["!cols"].push({wch:10})}setTimeout(()=>{const l=e.name&&e.name.length>0?e.name:"空分组信息"+t;m.a.utils.book_append_sheet(n,i,l),m.a.writeFile(n,l+".xlsx")},5e3)}}}(i),1e3*i)},getGroups:function(t,e){var n={};t.forEach(t=>{if(n[t[e]])n[t[e]].list.push(t);else{const l={list:[t]};l[e]=t[e],n[t[e]]=l}});const l=[];for(var s in n)l.push(n[s]);return l},uploadAction:function(t,e){console.log(t,e),this.fileList.push(t)},processFile(t,e){const n=new FileReader;n.onload=t=>{const n=t.target.result,l=m.a.read(n,{type:"binary"}),s=l.SheetNames[0],i=l.Sheets[s];e.cols=this.getHeaderRow(i);const o=[],r=m.a.utils.sheet_to_json(i,{header:1});for(let e=1;e<r.length;e++){const t=r[e],n={};for(let e=0;e<t.length;e++)n["column"+e]=t[e]?t[e]+"":"";o.push(n)}e.list=o};const l=t.size/1024/1024;(l<.5||confirm("攀岩志提示: 文件有点大，"+l.toFixed(2)+"M，比较耗时，确认继续么？"))&&n.readAsBinaryString(t.raw)},getHeaderRow:function(t){const e=[],n=m.a.utils.decode_range(t["!ref"]);let l;const s=n.s.r;for(l=n.s.c;l<=n.e.c;++l){const n=t[m.a.utils.encode_cell({c:l,r:s})];let i="UNKNOWN "+l;n&&n.t&&(i=m.a.utils.format_cell(n));const o={id:"column"+l,name:i};e.push(o)}return e}}},g=b,y=(n("8b98"),Object(a["a"])(g,h,p,!1,null,"625eb2fd",null)),_=y.exports,v=function(){var t=this,e=t._self._c;return e("div",{staticClass:"x-home"},[e("el-upload",{staticClass:"upload-demo",attrs:{multiple:"",action:"","on-change":t.uploadAction,"auto-upload":!1,"file-list":t.fileList}},[e("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")])],1),e("el-divider",{attrs:{"content-position":"left"}},[t._v("操作表格 - 车牌号提取")]),e("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.previewTables("preview")}}},[t._v("预览表格")]),e("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.fetch1()}}},[t._v("常规提取")]),e("el-divider",{attrs:{"content-position":"center"}},[t._v("author - wx: angewechat")]),"preview"===t.index?e("div",{staticStyle:{width:"100%"}},t._l(t.tables,(function(n,l){return e("div",{key:"table-"+l,staticStyle:{width:"100%","margin-right":"8px",float:"left"}},[n.list.length>0?[e("p",{staticStyle:{"font-size":"12px"}},[t._v("共"+t._s(n.list.length)+"条数据 - "+t._s(n.title))]),e("el-table",{attrs:{data:n.list,height:"600px",border:"",stripe:"",size:"small"}},[e("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),t._l(n.cols,(function(t,n){return e("el-table-column",{key:"x-"+n,attrs:{prop:t.id,label:t.name}})}))],2)]:e("p",[t._v("文件解析中...")])],2)})),0):"new"===t.index?e("div",{staticStyle:{width:"100%"}},[e("div",{staticStyle:{width:"100%","margin-right":"8px",float:"left"}},[e("p",{staticStyle:{"font-size":"12px"}},[t._v(t._s(t.result.title))]),e("el-table",{attrs:{data:t.result.list,border:"",stripe:"",size:"small",height:"600px"}},t._l(t.result.cols,(function(t,n){return e("el-table-column",{key:"x-"+n,attrs:{prop:t.id,label:t.name}})})),1)],1)]):t._e()],1)},x=[],w={name:"CarNumber",props:{item:{type:Object,default:function(){return{}}}},data(){return{tables:[],result:{title:"合并后的表格",list:[],cols:[]},fileList:[],index:"xxx",num:8}},methods:{previewTables:function(t){this.index=t,this.tables=[];for(let e=0;e<this.fileList.length;e++){const t=this.fileList[e],n={title:t.name,list:[],cols:[]};this.tables.push(n),this.processFile(t,n)}},fetch1:function(){if(!this.tables||0===this.tables.length)return void this.$message.error("上传文件，预览表格后，才可导出哦~~~");const t=[],e=[],n=this.tables[0].list;for(let r=0;r<n.length;r++){const l=n[r].column0.replace("于","，").replace("在","，"),s=l.replace(/,/g,"，").split("，"),i={carNumber:this.getNumber(s),date:this.getDate(s),money1:this.getMoney(s),company:n[r].column1,raw:n[r].column0};this.isVehicleNumber(i.carNumber)?t.push(i):e.push(i)}this.$message.warning(`一共${n.length}条数据，正确提取到${t.length}个车牌号`);const l={company:"印章所属公司",carNumber:"车牌号",date:"日期",money1:"金额",raw:"使用事由"},s=[l,...t,{company:"以下是坏数据",carNumber:"以下是坏数据",date:"",money1:"",raw:""},...e],i=m.a.utils.book_new(),o=m.a.utils.json_to_sheet(s,{skipHeader:!0});o["!cols"]=[{wch:50},{wch:20},{wch:20},{wch:20},{wch:200}],m.a.utils.book_append_sheet(i,o,"提取结果"),m.a.writeFile(i,"车牌等关键信息提取.xlsx")},getNumber:function(t){const e=t.find(t=>t.indexOf("车")>=0);if(e&&e.split("车").length>1){const n=e.split("车")[1].replace("辆","");return n&&n.length>0?n.replace(/\s+/g,""):t.find(t=>this.isVehicleNumber(t))}return t.find(t=>this.isVehicleNumber(t))},getDate:function(t){let e=t.find(t=>t.indexOf("日")>=0);if(e){let t=e.match(/在(.*?)日/);return t?t[1]+"日":(t=e.match(/(.*?)日/),t?t[1]+"日":"??日")}if(e=t.find(t=>t.indexOf("号")>=0),e){let t=e.match(/在(.*?)号/);return t?t[1]+"日":(t=e.match(/(.*?)号/),t?t[1]+"日":"??号")}return"??"},getMoney:function(t){let e=t.find(t=>t.indexOf("元")>=0);if(e){let t=e.match(/为(.*?)元/);return t?t[1]:(t=e.match(/金额(.*?)元/),t?t[1]:"??元")}if(e=t.find(t=>t.indexOf("金额")>=0),e){const t=e.match(/金额(.*?)/);return t?t[1]:"金额??"}if(e=t.find(t=>t.indexOf("定损")>=0),e){const t=e.match(/定损(.*?)/);return t?t[1]:"定损??"}return"??"},uploadAction:function(t,e){console.log(t,e),this.fileList.push(t)},processFile(t,e){const n=new FileReader;n.onload=t=>{const n=t.target.result,l=m.a.read(n,{type:"binary"}),s=l.SheetNames[0],i=l.Sheets[s];e.cols=this.getHeaderRow(i);const o=[],r=m.a.utils.sheet_to_json(i,{header:1});for(let e=1;e<r.length;e++){const t=r[e],n={};for(let e=0;e<t.length;e++)n["column"+e]=t[e]?t[e]+"":"";o.push(n)}e.list=o};const l=t.size/1024/1024;(l<.5||confirm("攀岩志提示: 文件有点大，"+l.toFixed(2)+"M，比较耗时，确认继续么？"))&&n.readAsBinaryString(t.raw)},isVehicleNumber:function(t){const e="京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领",n=t&&t.length>0&&e.indexOf(t.substring(0,1))>=0;if(n){const e=t.substring(t.length-1),l=/^[\u4e00-\u9fa5]+$/;return n&&!l.test(e)}return n},getHeaderRow:function(t){const e=[],n=m.a.utils.decode_range(t["!ref"]);let l;const s=n.s.r;for(l=n.s.c;l<=n.e.c;++l){const n=t[m.a.utils.encode_cell({c:l,r:s})];let i="UNKNOWN "+l;n&&n.t&&(i=m.a.utils.format_cell(n));const o={id:"column"+l,name:i};e.push(o)}return e}}},O=w,k=(n("eab5"),Object(a["a"])(O,v,x,!1,null,"5e21ee6e",null)),S=k.exports;l["default"].use(f["a"]);const j=new f["a"]({routes:[{path:"/",name:"Home",component:_},{path:"/car/number",name:"CarNumber",component:S}]});var N=j,z=n("8e41"),T=n.n(z);n("fcea");l["default"].use(T.a),l["default"].config.productionTip=!1,new l["default"]({router:N,render:t=>t(u)}).$mount("#app")},5938:function(t,e,n){},8834:function(t,e,n){},"8b98":function(t,e,n){"use strict";n("dab3")},cfd3:function(t,e,n){"use strict";n("5938")},dab3:function(t,e,n){},eab5:function(t,e,n){"use strict";n("8834")}});
//# sourceMappingURL=app.b3e4074b.js.map