(function(t){function e(e){for(var l,i,r=e[0],a=e[1],c=e[2],f=0,p=[];f<r.length;f++)i=r[f],Object.prototype.hasOwnProperty.call(s,i)&&s[i]&&p.push(s[i][0]),s[i]=0;for(l in a)Object.prototype.hasOwnProperty.call(a,l)&&(t[l]=a[l]);u&&u(e);while(p.length)p.shift()();return o.push.apply(o,c||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],l=!0,r=1;r<n.length;r++){var a=n[r];0!==s[a]&&(l=!1)}l&&(o.splice(e--,1),t=i(i.s=n[0]))}return t}var l={},s={app:0},o=[];function i(e){if(l[e])return l[e].exports;var n=l[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=l,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var l in t)i.d(n,l,function(e){return t[e]}.bind(null,l));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],a=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var u=a;o.push([1,"chunk-vendors"]),n()})({0:function(t,e){},1:function(t,e,n){t.exports=n("56d7")},2:function(t,e){},"23ab":function(t,e,n){},3:function(t,e){},"56d7":function(t,e,n){"use strict";n.r(e);var l=n("f568"),s=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},o=[],i={name:"App"},r=i,a=(n("cfd3"),n("0b56")),c=Object(a["a"])(r,s,o,!1,null,null,null),u=c.exports,f=n("f038"),p=function(){var t=this,e=t._self._c;return e("div",{staticClass:"x-home"},[e("el-upload",{staticClass:"upload-demo",attrs:{multiple:"",action:"","on-change":t.uploadAction,"auto-upload":!1,"file-list":t.fileList}},[e("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")])],1),e("el-divider",{attrs:{"content-position":"left"}},[t._v("操作表格")]),e("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.previewTables("preview")}}},[t._v("预览表格")]),e("el-input-number",{staticStyle:{margin:"0 20px"},attrs:{label:"按第几列分组",size:"small"},model:{value:t.num,callback:function(e){t.num=e},expression:"num"}}),e("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.exportTable("one")}}},[t._v("导出一个表格")]),e("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.exportTable("more")}}},[t._v("导出多个表格")]),e("el-divider",{attrs:{"content-position":"center"}},[t._v("author - wx: angewechat")]),"preview"===t.index?e("div",{staticStyle:{width:"100%"}},t._l(t.tables,(function(n,l){return e("div",{key:"table-"+l,staticStyle:{width:"100%","margin-right":"8px",float:"left"}},[n.list.length>0?[e("p",{staticStyle:{"font-size":"12px"}},[t._v("共"+t._s(n.list.length)+"条数据 - "+t._s(n.title))]),e("el-table",{attrs:{data:n.list,height:"600px",border:"",stripe:"",size:"small"}},[e("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),t._l(n.cols,(function(t,n){return e("el-table-column",{key:"x-"+n,attrs:{prop:t.id,label:t.name}})}))],2)]:e("p",[t._v("文件解析中...")])],2)})),0):"new"===t.index?e("div",{staticStyle:{width:"100%"}},[e("div",{staticStyle:{width:"100%","margin-right":"8px",float:"left"}},[e("p",{staticStyle:{"font-size":"12px"}},[t._v(t._s(t.result.title))]),e("el-table",{attrs:{data:t.result.list,border:"",stripe:"",size:"small",height:"600px"}},t._l(t.result.cols,(function(t,n){return e("el-table-column",{key:"x-"+n,attrs:{prop:t.id,label:t.name}})})),1)],1)]):t._e()],1)},h=[],d=(n("24b8"),n("b2f4"),n("c886")),b=n.n(d),m={name:"Home",props:{item:{type:Object,default:function(){return{}}}},data(){return{tables:[],result:{title:"合并后的表格",list:[],cols:[]},fileList:[],index:"xxx",num:8}},methods:{previewTables:function(t){this.index=t,this.tables=[];for(let e=0;e<this.fileList.length;e++){const t=this.fileList[e],n={title:t.name,list:[],cols:[]};this.tables.push(n),this.processFile(t,n)}},createTable:function(t){this.index=t,this.fileList.length<3&&alert("应该是三个表格");for(let e=0;e<this.tables[2].list.length;e++){const t=this.tables[2].list[e];let n=null,l=null;for(let e=0;e<this.tables[1].list.length;e++){const l=this.tables[1].list[e],s=Object.keys(l);for(let e=0;e<s.length;e++){const o=s[e];l[o]+""===t.column0+""&&(n=l)}}for(let e=0;e<this.tables[0].list.length;e++){const n=this.tables[0].list[e],s=Object.keys(n);for(let e=0;e<s.length;e++){const o=s[e];n[o]+""===t.column2+""&&(l=n)}}t&&n&&l?console.log(t,n,l):console.log("不合法")}},exportTable:function(t="one"){const e=this.tables[0].list,n={};for(let o=0;o<this.tables[0].cols.length;o++){const t=this.tables[0].cols[o];n[t.id]=t.name}const l=[],s="column"+(this.num-1);for(let o=0;o<e.length;o++){const t=e[o],i=l.find(e=>e.name===t[s]);if(i)console.log("已存在",t[s]);else{const o={name:t[s],list:e.filter(e=>e[s]===t[s])};o.list.unshift(n),l.push(o)}}if("one"===t){const t=b.a.utils.book_new();for(let e=0;e<l.length;e++){const n=l[e];if(n.list.length){console.log("组:",e,n.name);const l=n.list[0],s=Object.keys(l),o=b.a.utils.json_to_sheet(n.list,{skipHeader:!0});o["!cols"]=[];for(let t=0;t<s.length;t++){const e=s[t];l[e]?o["!cols"].push({wch:2*(l[e]+"").length+10}):o["!cols"].push({wch:10})}b.a.utils.book_append_sheet(t,o,n.name)}}b.a.writeFile(t,"分组后.xlsx")}else if(confirm("攀岩志提示: 一共将的导出"+l.length+"个表格, 下载大概需要用时"+1.5*l.length/60+"min，确定下载？"))for(let o=0;o<l.length;o++)setTimeout(function(t){return function(){const e=l[t];if(e.list.length){console.log("组:",t,e.name);const n=b.a.utils.book_new(),l=e.list[0],s=Object.keys(l),o=b.a.utils.json_to_sheet(e.list,{skipHeader:!0});o["!cols"]=[];for(let t=0;t<s.length;t++){const e=s[t];l[e]?o["!cols"].push({wch:2*(l[e]+"").length+10}):o["!cols"].push({wch:10})}setTimeout(()=>{const l=e.name&&e.name.length>0?e.name:"空分组信息"+t;b.a.utils.book_append_sheet(n,o,l),b.a.writeFile(n,l+".xlsx")},5e3)}}}(o),1e3*o)},getGroups:function(t,e){var n={};t.forEach(t=>{if(n[t[e]])n[t[e]].list.push(t);else{const l={list:[t]};l[e]=t[e],n[t[e]]=l}});const l=[];for(var s in n)l.push(n[s]);return l},uploadAction:function(t,e){console.log(t,e),this.fileList.push(t)},processFile(t,e){const n=new FileReader;n.onload=t=>{const n=t.target.result,l=b.a.read(n,{type:"binary"}),s=l.SheetNames[0],o=l.Sheets[s];e.cols=this.getHeaderRow(o);const i=[],r=b.a.utils.sheet_to_json(o,{header:1});for(let e=1;e<r.length;e++){const t=r[e],n={};for(let e=0;e<t.length;e++)n["column"+e]=t[e]?t[e]+"":"";i.push(n)}e.list=i};const l=t.size/1024/1024;(l<.5||confirm("攀岩志提示: 文件有点大，"+l.toFixed(2)+"M，比较耗时，确认继续么？"))&&n.readAsBinaryString(t.raw)},getHeaderRow:function(t){const e=[],n=b.a.utils.decode_range(t["!ref"]);let l;const s=n.s.r;for(l=n.s.c;l<=n.e.c;++l){const n=t[b.a.utils.encode_cell({c:l,r:s})];let o="UNKNOWN "+l;n&&n.t&&(o=b.a.utils.format_cell(n));const i={id:"column"+l,name:o};e.push(i)}return e}}},g=m,v=(n("bbe6"),Object(a["a"])(g,p,h,!1,null,"f45a9a88",null)),y=v.exports;l["default"].use(f["a"]);const _=new f["a"]({routes:[{path:"/",name:"Home",component:y}]});var w=_,x=n("8e41"),k=n.n(x);n("fcea");l["default"].use(k.a),l["default"].config.productionTip=!1,new l["default"]({router:w,render:t=>t(u)}).$mount("#app")},5938:function(t,e,n){},bbe6:function(t,e,n){"use strict";n("23ab")},cfd3:function(t,e,n){"use strict";n("5938")}});
//# sourceMappingURL=app.69a8c833.js.map