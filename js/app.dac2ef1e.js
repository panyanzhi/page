(function(t){function e(e){for(var s,i,r=e[0],a=e[1],c=e[2],p=0,f=[];p<r.length;p++)i=r[p],Object.prototype.hasOwnProperty.call(l,i)&&l[i]&&f.push(l[i][0]),l[i]=0;for(s in a)Object.prototype.hasOwnProperty.call(a,s)&&(t[s]=a[s]);u&&u(e);while(f.length)f.shift()();return o.push.apply(o,c||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],s=!0,r=1;r<n.length;r++){var a=n[r];0!==l[a]&&(s=!1)}s&&(o.splice(e--,1),t=i(i.s=n[0]))}return t}var s={},l={app:0},o=[];function i(e){if(s[e])return s[e].exports;var n=s[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=s,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],a=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var u=a;o.push([1,"chunk-vendors"]),n()})({0:function(t,e){},"07d1":function(t,e,n){},1:function(t,e,n){t.exports=n("56d7")},2:function(t,e){},3:function(t,e){},4:function(t,e){},"56d7":function(t,e,n){"use strict";n.r(e);var s=n("b339"),l=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[t.$route.meta.keepAlive?t._e():e("router-view"),e("keep-alive",[t.$route.meta.keepAlive?e("router-view"):t._e()],1)],1)},o=[],i={name:"App"},r=i,a=(n("fa37"),n("e607")),c=Object(a["a"])(r,l,o,!1,null,null,null),u=c.exports;function p(t){return t<10?"0"+t:t}s["default"].filter("formatDate",(function(t,e){if("0"!==t&&(""===t||void 0===t||null===t))return"--";let n="格式化失败",s=t;s instanceof Date||(s=new Date(t));const l=s.getFullYear(),o=s.getMonth()+1,i=s.getDate();if("yyyy-MM-dd"===e)n=l+"-"+p(o)+"-"+p(i);else if("yyyy-M-d"===e)n=l+"-"+o+"-"+i;else{const t=s.getHours(),e=s.getMinutes();n=l+"-"+p(o)+"-"+p(i)+" "+p(t)+":"+p(e)}return n})),s["default"].filter("shortTitle",(function(t,e){return t&&t.length>e?t.substring(0,e)+"...":t})),s["default"].filter("fileSizeName",(function(t){if(null===t||""===t||0===t)return"--";const e=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"];let n=0;const s=parseFloat(t);n=Math.floor(Math.log(s)/Math.log(1024));let l=s/Math.pow(1024,n);l=l.toFixed(2);const o=l.indexOf(".00");return-1!==o&&(l=l.substring(0,o)),l+e[n]}));var f=n("7736");s["default"].use(f["a"]);const h=new f["a"].Store({state:{user:null},mutations:{login(t,e){t.user=e}},getters:{isTest:function(){return!1},isLogin:function(t){return null!==t.user&&void 0!==t.user}}});var d=h,m=n("f038"),g=function(){var t=this,e=t._self._c;return e("div",{staticClass:"pyz-home"},[e("ul",[e("li",[e("p",{style:{color:t.color},attrs:{id:"title"}},[t._v("欢迎您"),t.from?e("span",[t._v("从“"+t._s(t.from)+"”")]):t._e(),t._v("来到这儿！")])]),t._m(0),t._m(1),e("li",[e("p",[t._v("专业编程技术栈：(经验值："),e("span",{attrs:{id:"jy1"}},[t._v(t._s(t.year-2012)+"年，"+t._s(t.year))]),t._v(")")]),e("p",[t._v("Java、C#、C、Flutter、iOS、Android、Electron、Vue、Python、Echart等")])]),e("li",[e("p",[t._v("专业软件开发：(经验值："),e("span",{attrs:{id:"jy2"}},[t._v(t._s(t.year-2013)+"年，"+t._s(t.year))]),t._v(")")]),e("p",[t._v("毕设答疑，App、小程序、ERP系统、OA系统、客户端、门户网站、运营管理系统、爬虫、大数据分析等各种软件开发")])]),e("li",[e("p",[t._v("专业设计：(经验值："),e("span",{attrs:{id:"jy3"}},[t._v(t._s(t.year-2013)+"年，"+t._s(t.year))]),t._v(")")]),e("p",[t._v("UI 设计、海报、官网、Logo等平面设计。")])]),t._m(2),e("li",{staticStyle:{"text-align":"center","margin-top":"20px"}},[e("p",{staticStyle:{border:"1px dashed magenta",padding:"8px",display:"inline-block"},style:{borderColor:t.color},attrs:{id:"contact"}},[e("img",{attrs:{src:n("9946"),width:"260px"}})]),e("p",{staticStyle:{"font-size":"14px",padding:"8px 0"},style:{color:t.color}},[t._v("扫一扫或长按识别加微信")])])]),e("iframe",{attrs:{src:"https://panyanzhi.github.io/page/time.html",frameborder:"0",width:"100%",height:"150"}})])},b=[function(){var t=this,e=t._self._c;return e("li",[e("h2",[t._v("交流与合作")])])},function(){var t=this,e=t._self._c;return e("li",[e("p",[t._v("昵称：攀岩志（团队）")]),e("p",[t._v("我们由一群热爱开发的小伙伴组队而成，期望与同道中人交流探讨软件开发技术。")]),e("p",[t._v("也期待广大有志者愿意让我们为您打造专业、趁手的软件利器，利用“互联网+”形式来管理或推广自己的产品与业务。")])])},function(){var t=this,e=t._self._c;return e("li",[e("p",[t._v(" 联系方式：微信 ")])])}],y=(n("149f"),n("82ae")),_=n.n(y),v=(n("34d3"),n("23c5")),w=n.n(v);_.a.defaults.withCredentials=!0,_.a.defaults.baseURL="",_.a.defaults.timeout=1e5,_.a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8",_.a.interceptors.request.use(t=>t,t=>Promise.error(t)),_.a.interceptors.response.use(t=>{if(200!==t.status)return Promise.reject(t);{const e=t.data.code,n=e<=1e3&&e>0;if(!n)return Promise.resolve(t);k(t.data.message,e)}},t=>{const e=t.response,n=e.status;if(n)switch(n){case 401:e.data?k(e.data.message,e.data.code):k("非法用户，即将退出登录",401);break;case 403:S();break;case 504:case 404:k("网络请求不存在!");break;case 500:if(e.data){const t=e.data.code,n=t<=1e3&&t>0;if(!n)return Promise.resolve(e);403===t?S():k(e.data.message,t)}else k(e.message,n);break;default:j(n)}else j("error")}),_.a.jsonp=(t,e)=>{if(!t)return void k("Axios.JSONP 至少需要一个url参数!");const n="CALLBACK"+Math.random().toString().substr(9,18),s=document.createElement("script");s.setAttribute("type","text/javascript");const l=document.getElementsByTagName("head")[0];let o="";if(e){if("string"===typeof e)o="&"+e;else if("object"===typeof e)for(const t in e)o+="&"+t+"="+encodeURIComponent(e[t]);o+="&_time="+Date.now()}return s.src=`${t}?callback=${n}${o}`,new Promise(t=>{window[n]=e=>{t(e),l.removeChild(s),delete window[n]},l.appendChild(s)})};const x=(t,e)=>new Promise((n,s)=>{_.a.post(t,e,{headers:{"Content-Type":"application/json"}}).then(t=>{n(t.data)}).catch(t=>{s(t.data)})});function k(t,e){t&&t.length>0?v["Message"].error({message:t}):j(e)}function j(t){let e=t+" : 未知错误";k(e)}const S=function(){let t=["nav_user","space1","space2","space4"];for(let n=0;n<t.length;n++){const e=t[n];sessionStorage.removeItem(e)}let e=location.protocol+"//"+location.host;window.open(e+"/login.html","_self")},O={postMessage:function(t){const e="";return x(e,{msgtype:"markdown",markdown:{content:`<font color="comment">${t}</font>\n           >发自<font color="warning">xx</font>`}})}};var z={name:"Home",data(){return{from:"",year:2022,color:"#409EFF",textarea:null}},created(){this.from=this.$route.query&&this.$route.query.from,this.year=(new Date).getFullYear()},methods:{submit:function(){this.textarea&&0!==this.textarea.length?O.postMessage(this.textarea).then(t=>{console.log(t)}):this.$message.warning("请输入留言内容")}}},M=z,T=(n("a07d"),Object(a["a"])(M,g,b,!1,null,"16443b59",null)),A=T.exports,F=function(){var t=this,e=t._self._c;return e("div",{staticClass:"x-home"},[e("el-upload",{staticClass:"upload-demo",attrs:{multiple:"",action:"","on-change":t.uploadAction,"auto-upload":!1,"file-list":t.fileList}},[e("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")])],1),e("el-divider",{attrs:{"content-position":"left"}},[t._v("操作表格 - 车牌号提取")]),e("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.previewTables("preview")}}},[t._v("预览表格")]),e("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.fetch1()}}},[t._v("常规提取")]),e("el-divider",{attrs:{"content-position":"center"}},[e("el-link",{attrs:{type:"primary",href:"/#/?from=操作表格 - 车牌号提取"}},[t._v("开发者详情")])],1),"preview"===t.index?e("div",{staticStyle:{width:"100%"}},t._l(t.tables,(function(n,s){return e("div",{key:"table-"+s,staticStyle:{width:"100%","margin-right":"8px",float:"left"}},[n.list.length>0?[e("p",{staticStyle:{"font-size":"12px"}},[t._v("共"+t._s(n.list.length)+"条数据 - "+t._s(n.title))]),e("el-table",{attrs:{data:n.list,height:"600px",border:"",stripe:"",size:"small"}},[e("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),t._l(n.cols,(function(t,n){return e("el-table-column",{key:"x-"+n,attrs:{prop:t.id,label:t.name}})}))],2)]:e("p",[t._v("文件解析中...")])],2)})),0):"new"===t.index?e("div",{staticStyle:{width:"100%"}},[e("div",{staticStyle:{width:"100%","margin-right":"8px",float:"left"}},[e("p",{staticStyle:{"font-size":"12px"}},[t._v(t._s(t.result.title))]),e("el-table",{attrs:{data:t.result.list,border:"",stripe:"",size:"small",height:"600px"}},t._l(t.result.cols,(function(t,n){return e("el-table-column",{key:"x-"+n,attrs:{prop:t.id,label:t.name}})})),1)],1)]):t._e()],1)},N=[],C=n("c886"),P=n.n(C),L={name:"CarNumber",props:{item:{type:Object,default:function(){return{}}}},data(){return{tables:[],result:{title:"合并后的表格",list:[],cols:[]},fileList:[],index:"xxx",num:8}},methods:{previewTables:function(t){this.index=t,this.tables=[];for(let e=0;e<this.fileList.length;e++){const t=this.fileList[e],n={title:t.name,list:[],cols:[]};this.tables.push(n),this.processFile(t,n)}},fetch1:function(){if(!this.tables||0===this.tables.length)return void this.$message.error("上传文件，预览表格后，才可导出哦~~~");const t=[],e=[],n=this.tables[0].list;for(let r=0;r<n.length;r++){const s=n[r].column0,l={carNumber:this.getNumber(s),date:this.getDate(s),money1:this.getMoney(s),company:n[r].column1,raw:n[r].column0};"??"===l.carNumber?e.push(l):t.push(l)}this.$message.warning(`一共${n.length}条数据，正确提取到${t.length}个车牌号`);const s={company:"印章所属公司",carNumber:"车牌号",date:"日期",money1:"金额",raw:"使用事由"},l=[s,...t,{company:"以下是坏数据",carNumber:"以下是坏数据",date:"",money1:"",raw:""},...e],o=P.a.utils.book_new(),i=P.a.utils.json_to_sheet(l,{skipHeader:!0});i["!cols"]=[{wch:50},{wch:20},{wch:20},{wch:20},{wch:200}],P.a.utils.book_append_sheet(o,i,"提取结果"),P.a.writeFile(o,"车牌等关键信息提取.xlsx")},getNumber:function(t){const e=t.match(/[测京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领]{1}[A-Z]{1}[A-Z0-9]{1,5}[A-Z0-9挂学警港澳]{1}/g);return e?e.join(","):"??"},getDate:function(t){const e=t.match(/(20[0-2]{2}[年/])?[0-9]{1,2}[月/][0-9]{1,2}[号日]*/g);return e?e.join(","):"??"},getMoney:function(t){const e=t.match(/[\w.]+元/g);return e?e.join(","):"??"},uploadAction:function(t,e){console.log(t,e),this.fileList.push(t)},processFile(t,e){const n=new FileReader;n.onload=t=>{const n=t.target.result,s=P.a.read(n,{type:"binary"}),l=s.SheetNames[0],o=s.Sheets[l];e.cols=this.getHeaderRow(o);const i=[],r=P.a.utils.sheet_to_json(o,{header:1});for(let e=1;e<r.length;e++){const t=r[e],n={};for(let e=0;e<t.length;e++)n["column"+e]=t[e]?t[e]+"":"";i.push(n)}e.list=i};const s=t.size/1024/1024;(s<.5||confirm("攀岩志提示: 文件有点大，"+s.toFixed(2)+"M，比较耗时，确认继续么？"))&&n.readAsBinaryString(t.raw)},getHeaderRow:function(t){const e=[],n=P.a.utils.decode_range(t["!ref"]);let s;const l=n.s.r;for(s=n.s.c;s<=n.e.c;++s){const n=t[P.a.utils.encode_cell({c:s,r:l})];let o="UNKNOWN "+s;n&&n.t&&(o=P.a.utils.format_cell(n));const i={id:"column"+s,name:o};e.push(i)}return e}}},$=L,B=(n("cd13"),Object(a["a"])($,F,N,!1,null,"00e80f8c",null)),H=B.exports,E=function(){var t=this,e=t._self._c;return e("div",{staticClass:"x-home"},[e("el-upload",{staticClass:"upload-demo",attrs:{multiple:"",action:"","on-change":t.uploadAction,"auto-upload":!1,"file-list":t.fileList}},[e("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")])],1),e("el-divider",{attrs:{"content-position":"left"}},[t._v("操作表格 - 按列分组")]),e("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.previewTables("preview")}}},[t._v("预览表格")]),e("el-input-number",{staticStyle:{margin:"0 20px"},attrs:{label:"按第几列分组",size:"small"},model:{value:t.num,callback:function(e){t.num=e},expression:"num"}}),e("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.exportTable("one")}}},[t._v("导出一个表格")]),e("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.exportTable("more")}}},[t._v("导出多个表格")]),e("el-divider",{attrs:{"content-position":"center"}},[e("el-link",{attrs:{type:"primary",href:"/#/?from=操作表格 - 按列分组"}},[t._v("开发者详情")])],1),"preview"===t.index?e("div",{staticStyle:{width:"100%"}},t._l(t.tables,(function(n,s){return e("div",{key:"table-"+s,staticStyle:{width:"100%","margin-right":"8px",float:"left"}},[n.list.length>0?[e("p",{staticStyle:{"font-size":"12px"}},[t._v("共"+t._s(n.list.length)+"条数据 - "+t._s(n.title))]),e("el-table",{attrs:{data:n.list,height:"600px",border:"",stripe:"",size:"small"}},[e("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),t._l(n.cols,(function(t,n){return e("el-table-column",{key:"x-"+n,attrs:{prop:t.id,label:t.name}})}))],2)]:e("p",[t._v("文件解析中...")])],2)})),0):"new"===t.index?e("div",{staticStyle:{width:"100%"}},[e("div",{staticStyle:{width:"100%","margin-right":"8px",float:"left"}},[e("p",{staticStyle:{"font-size":"12px"}},[t._v(t._s(t.result.title))]),e("el-table",{attrs:{data:t.result.list,border:"",stripe:"",size:"small",height:"600px"}},t._l(t.result.cols,(function(t,n){return e("el-table-column",{key:"x-"+n,attrs:{prop:t.id,label:t.name}})})),1)],1)]):t._e()],1)},R=[],D=(n("fef2"),{name:"Home",props:{item:{type:Object,default:function(){return{}}}},data(){return{tables:[],result:{title:"合并后的表格",list:[],cols:[]},fileList:[],index:"xxx",num:8}},methods:{previewTables:function(t){this.index=t,this.tables=[];for(let e=0;e<this.fileList.length;e++){const t=this.fileList[e],n={title:t.name,list:[],cols:[]};this.tables.push(n),this.processFile(t,n)}},createTable:function(t){this.index=t,this.fileList.length<3&&alert("应该是三个表格");for(let e=0;e<this.tables[2].list.length;e++){const t=this.tables[2].list[e];let n=null,s=null;for(let e=0;e<this.tables[1].list.length;e++){const s=this.tables[1].list[e],l=Object.keys(s);for(let e=0;e<l.length;e++){const o=l[e];s[o]+""===t.column0+""&&(n=s)}}for(let e=0;e<this.tables[0].list.length;e++){const n=this.tables[0].list[e],l=Object.keys(n);for(let e=0;e<l.length;e++){const o=l[e];n[o]+""===t.column2+""&&(s=n)}}t&&n&&s?console.log(t,n,s):console.log("不合法")}},exportTable:function(t="one"){const e=this.tables[0].list,n={};for(let o=0;o<this.tables[0].cols.length;o++){const t=this.tables[0].cols[o];n[t.id]=t.name}const s=[],l="column"+(this.num-1);for(let o=0;o<e.length;o++){const t=e[o],i=s.find(e=>e.name===t[l]);if(i)console.log("已存在",t[l]);else{const o={name:t[l],list:e.filter(e=>e[l]===t[l])};o.list.unshift(n),s.push(o)}}if("one"===t){const t=P.a.utils.book_new();for(let e=0;e<s.length;e++){const n=s[e];if(n.list.length){console.log("组:",e,n.name);const s=n.list[0],l=Object.keys(s),o=P.a.utils.json_to_sheet(n.list,{skipHeader:!0});o["!cols"]=[];for(let t=0;t<l.length;t++){const e=l[t];s[e]?o["!cols"].push({wch:2*(s[e]+"").length+10}):o["!cols"].push({wch:10})}P.a.utils.book_append_sheet(t,o,n.name)}}P.a.writeFile(t,"分组后.xlsx")}else if(confirm("攀岩志提示: 一共将的导出"+s.length+"个表格, 下载大概需要用时"+1.5*s.length/60+"min，确定下载？"))for(let o=0;o<s.length;o++)setTimeout(function(t){return function(){const e=s[t];if(e.list.length){console.log("组:",t,e.name);const n=P.a.utils.book_new(),s=e.list[0],l=Object.keys(s),o=P.a.utils.json_to_sheet(e.list,{skipHeader:!0});o["!cols"]=[];for(let t=0;t<l.length;t++){const e=l[t];s[e]?o["!cols"].push({wch:2*(s[e]+"").length+10}):o["!cols"].push({wch:10})}setTimeout(()=>{const s=e.name&&e.name.length>0?e.name:"空分组信息"+t;P.a.utils.book_append_sheet(n,o,s),P.a.writeFile(n,s+".xlsx")},5e3)}}}(o),1e3*o)},getGroups:function(t,e){var n={};t.forEach(t=>{if(n[t[e]])n[t[e]].list.push(t);else{const s={list:[t]};s[e]=t[e],n[t[e]]=s}});const s=[];for(var l in n)s.push(n[l]);return s},uploadAction:function(t,e){console.log(t,e),this.fileList.push(t)},processFile(t,e){const n=new FileReader;n.onload=t=>{const n=t.target.result,s=P.a.read(n,{type:"binary"}),l=s.SheetNames[0],o=s.Sheets[l];e.cols=this.getHeaderRow(o);const i=[],r=P.a.utils.sheet_to_json(o,{header:1});for(let e=1;e<r.length;e++){const t=r[e],n={};for(let e=0;e<t.length;e++)n["column"+e]=t[e]?t[e]+"":"";i.push(n)}e.list=i};const s=t.size/1024/1024;(s<.5||confirm("攀岩志提示: 文件有点大，"+s.toFixed(2)+"M，比较耗时，确认继续么？"))&&n.readAsBinaryString(t.raw)},getHeaderRow:function(t){const e=[],n=P.a.utils.decode_range(t["!ref"]);let s;const l=n.s.r;for(s=n.s.c;s<=n.e.c;++s){const n=t[P.a.utils.encode_cell({c:s,r:l})];let o="UNKNOWN "+s;n&&n.t&&(o=P.a.utils.format_cell(n));const i={id:"column"+s,name:o};e.push(i)}return e}}}),U=D,q=(n("81db"),Object(a["a"])(U,E,R,!1,null,"607b47ba",null)),J=q.exports;s["default"].use(m["a"]);const K=new m["a"]({routes:[{path:"/",component:A,name:"Home",meta:{title:"交流与合作"}},{path:"/excel/group",name:"GroupHome",component:J,meta:{title:"表格按列分组"}},{path:"/excel/car/number",name:"CarNumber",component:H,meta:{title:"表格提取车牌号"}}]});K.beforeEach((t,e,n)=>{t.meta.title&&(document.title="攀岩志团队 - "+t.meta.title),n()});const Z=m["a"].prototype.push;m["a"].prototype.push=function(t){return Z.call(this,t).catch(t=>t)};var G=K;s["default"].config.productionTip=!1,s["default"].use(w.a),s["default"].prototype.changeValue=function(t){return t.target.value},new s["default"]({render:t=>t(u),router:G,store:d}).$mount("#app")},"81db":function(t,e,n){"use strict";n("a48f")},9946:function(t,e,n){t.exports=n.p+"img/qiyewechat.cf7406ad.jpg"},a07d:function(t,e,n){"use strict";n("07d1")},a48f:function(t,e,n){},a81b:function(t,e,n){},cd13:function(t,e,n){"use strict";n("fc01")},fa37:function(t,e,n){"use strict";n("a81b")},fc01:function(t,e,n){}});
//# sourceMappingURL=app.dac2ef1e.js.map