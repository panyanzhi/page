(function(t){function e(e){for(var l,o,r=e[0],a=e[1],c=e[2],p=0,f=[];p<r.length;p++)o=r[p],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&f.push(s[o][0]),s[o]=0;for(l in a)Object.prototype.hasOwnProperty.call(a,l)&&(t[l]=a[l]);u&&u(e);while(f.length)f.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],l=!0,r=1;r<n.length;r++){var a=n[r];0!==s[a]&&(l=!1)}l&&(i.splice(e--,1),t=o(o.s=n[0]))}return t}var l={},s={app:0},i=[];function o(e){if(l[e])return l[e].exports;var n=l[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=l,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var l in t)o.d(n,l,function(e){return t[e]}.bind(null,l));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],a=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var u=a;i.push([1,"chunk-vendors"]),n()})({0:function(t,e){},"072b":function(t,e,n){},1:function(t,e,n){t.exports=n("56d7")},"1cb5":function(t,e,n){"use strict";n("4f79")},2:function(t,e){},"216c":function(t,e,n){t.exports=n.p+"img/form-msg.ce2f6cac.png"},"29c0":function(t,e,n){"use strict";n("072b")},3:function(t,e){},"4f79":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);var l=n("1f37"),s=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[t.$route.meta.keepAlive?t._e():e("router-view"),e("keep-alive",[t.$route.meta.keepAlive?e("router-view"):t._e()],1)],1)},i=[],o={name:"App"},r=o,a=(n("fa37"),n("e607")),c=Object(a["a"])(r,s,i,!1,null,null,null),u=c.exports;function p(t){return t<10?"0"+t:t}l["default"].filter("formatDate",(function(t,e){if("0"!==t&&(""===t||void 0===t||null===t))return"--";let n="格式化失败",l=t;l instanceof Date||(l=new Date(t));const s=l.getFullYear(),i=l.getMonth()+1,o=l.getDate();if("yyyy-MM-dd"===e)n=s+"-"+p(i)+"-"+p(o);else if("yyyy-M-d"===e)n=s+"-"+i+"-"+o;else{const t=l.getHours(),e=l.getMinutes();n=s+"-"+p(i)+"-"+p(o)+" "+p(t)+":"+p(e)}return n})),l["default"].filter("shortTitle",(function(t,e){return t&&t.length>e?t.substring(0,e)+"...":t})),l["default"].filter("fileSizeName",(function(t){if(null===t||""===t||0===t)return"--";const e=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"];let n=0;const l=parseFloat(t);n=Math.floor(Math.log(l)/Math.log(1024));let s=l/Math.pow(1024,n);s=s.toFixed(2);const i=s.indexOf(".00");return-1!==i&&(s=s.substring(0,i)),s+e[n]}));var f=n("7736");l["default"].use(f["a"]);const h=new f["a"].Store({state:{user:null},mutations:{login(t,e){t.user=e}},getters:{isTest:function(){return!1},isLogin:function(t){return null!==t.user&&void 0!==t.user}}});var d=h,m=n("f038"),b=function(){var t=this,e=t._self._c;return e("div",{staticClass:"pyz-home"},[e("ul",[e("li",[t.from?e("p",{staticStyle:{width:"100%"}},[t._v(" 欢迎您"),e("span",[t._v("从“"+t._s(t.from)+"”")]),t._v("来到这儿！ "),e("span",{staticClass:"el-icon-back",staticStyle:{float:"right","margin-top":"3px"},style:{color:t.color},on:{click:t.back}})]):e("p",[t._v(" 欢迎您来到这儿 ")])]),t._m(0),e("li",[e("p",[t._v(" 昵称：攀岩志（团队） "),e("el-popover",{attrs:{placement:"top",width:"160"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[e("p",[e("img",{staticStyle:{"max-width":"100%"},attrs:{src:n("216c")}})]),e("div",{staticStyle:{"text-align":"right",margin:"6px 0 2px 0"}},[e("span",{staticClass:"span-btn",staticStyle:{color:"#999"},on:{click:function(e){t.visible=!1}}},[t._v("取消")])]),e("span",{staticClass:"span-btn pyz-yellow",staticStyle:{float:"right"},attrs:{slot:"reference",type:"text"},slot:"reference"},[t._v("留言")])])],1),e("p",[t._v(" 我们由一群热爱开发的小伙伴组队而成，期望与同道中人交流探讨软件开发技术。 ")]),e("p",[t._v(" 也期待广大有志者愿意让我们为您打造专业、趁手的软件利器，利用“互联网+”形式来管理或推广自己的产品与业务。 ")])]),e("li",[e("p",[t._v(" 专业编程技术栈：(经验值："),e("span",[t._v(t._s(t.year-2012)+"年，"+t._s(t.year))]),t._v(") ")]),e("p",[t._v(" Java、C#、C、Flutter、iOS、Android、Electron、Vue、Python、Echart等 ")])]),e("li",[e("p",[t._v(" 专业软件开发：(经验值："),e("span",[t._v(t._s(t.year-2013)+"年，"+t._s(t.year))]),t._v(") ")]),e("p",[t._v(" 毕设答疑，App、小程序、ERP系统、OA系统、客户端、门户网站、运营管理系统、爬虫、大数据分析等各种软件开发 ")])]),e("li",[e("p",[t._v(" 专业设计：(经验值："),e("span",[t._v(t._s(t.year-2013)+"年，"+t._s(t.year))]),t._v(") ")]),e("p",[t._v("UI 设计、海报、官网、Logo等平面设计")])]),t._m(1),e("li",{staticStyle:{"text-align":"center","margin-top":"20px"}},[e("p",{staticStyle:{border:"1px dashed magenta","border-radius":"4px",padding:"8px",display:"inline-block"},style:{borderColor:t.color}},[e("img",{attrs:{src:n("bcc3"),width:"200px"}})]),e("p",{staticStyle:{"font-size":"14px",padding:"8px 0"},style:{color:t.color}},[t._v(" 扫一扫或长按识别加微信 ")])])]),e("iframe",{attrs:{src:"https://panyanzhi.github.io/page/time.html",frameborder:"0",width:"100%",height:"150"}})])},g=[function(){var t=this,e=t._self._c;return e("li",[e("h2",[t._v("交流与合作")])])},function(){var t=this,e=t._self._c;return e("li",[e("p",[t._v(" 联系方式：微信 ")])])}],y={name:"Home",data(){return{from:"",year:2022,color:"#999",visible:!1}},created(){this.from=this.$route.query&&this.$route.query.from,this.year=(new Date).getFullYear()},methods:{back:function(){window.history.go(-1)}}},v=y,_=(n("c21b"),Object(a["a"])(v,b,g,!1,null,"89fa0d0a",null)),x=_.exports,w=function(){var t=this,e=t._self._c;return e("div",{staticClass:"x-home"},[e("el-upload",{staticClass:"upload-demo",attrs:{multiple:"",action:"","on-change":t.uploadAction,"auto-upload":!1,"file-list":t.fileList}},[e("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")])],1),e("el-divider",{attrs:{"content-position":"left"}},[t._v("操作表格 - 车牌号提取")]),e("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.previewTables("preview")}}},[t._v("预览表格")]),e("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.fetch1()}}},[t._v("常规提取")]),e("el-divider",{attrs:{"content-position":"center"}},[e("el-link",{attrs:{type:"primary",href:"/page/#/?from=操作表格 - 车牌号提取"}},[t._v("开发者详情")])],1),"preview"===t.index?e("div",{staticStyle:{width:"100%"}},t._l(t.tables,(function(n,l){return e("div",{key:"table-"+l,staticStyle:{width:"100%","margin-right":"8px",float:"left"}},[n.list.length>0?[e("p",{staticStyle:{"font-size":"12px"}},[t._v("共"+t._s(n.list.length)+"条数据 - "+t._s(n.title))]),e("el-table",{attrs:{data:n.list,height:"600px",border:"",stripe:"",size:"small"}},[e("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),t._l(n.cols,(function(t,n){return e("el-table-column",{key:"x-"+n,attrs:{prop:t.id,label:t.name}})}))],2)]:e("p",[t._v("文件解析中...")])],2)})),0):"new"===t.index?e("div",{staticStyle:{width:"100%"}},[e("div",{staticStyle:{width:"100%","margin-right":"8px",float:"left"}},[e("p",{staticStyle:{"font-size":"12px"}},[t._v(t._s(t.result.title))]),e("el-table",{attrs:{data:t.result.list,border:"",stripe:"",size:"small",height:"600px"}},t._l(t.result.cols,(function(t,n){return e("el-table-column",{key:"x-"+n,attrs:{prop:t.id,label:t.name}})})),1)],1)]):t._e()],1)},k=[],S=(n("149f"),n("c886")),j=n.n(S),O={name:"CarNumber",props:{item:{type:Object,default:function(){return{}}}},data(){return{tables:[],result:{title:"合并后的表格",list:[],cols:[]},fileList:[],index:"xxx",num:8}},methods:{previewTables:function(t){this.index=t,this.tables=[];for(let e=0;e<this.fileList.length;e++){const t=this.fileList[e],n={title:t.name,list:[],cols:[]};this.tables.push(n),this.processFile(t,n)}},fetch1:function(){if(!this.tables||0===this.tables.length)return void this.$message.error("上传文件，预览表格后，才可导出哦~~~");const t=[],e=[],n=this.tables[0].list;for(let r=0;r<n.length;r++){const l=n[r].column0,s={carNumber:this.getNumber(l),date:this.getDate(l),money1:this.getMoney(l),company:n[r].column1,raw:n[r].column0};"??"===s.carNumber?e.push(s):t.push(s)}this.$message.warning(`一共${n.length}条数据，正确提取到${t.length}个车牌号`);const l={company:"印章所属公司",carNumber:"车牌号",date:"日期",money1:"金额",raw:"使用事由"},s=[l,...t,{company:"以下是坏数据",carNumber:"以下是坏数据",date:"",money1:"",raw:""},...e],i=j.a.utils.book_new(),o=j.a.utils.json_to_sheet(s,{skipHeader:!0});o["!cols"]=[{wch:50},{wch:20},{wch:20},{wch:20},{wch:200}],j.a.utils.book_append_sheet(i,o,"提取结果"),j.a.writeFile(i,"车牌等关键信息提取.xlsx")},getNumber:function(t){const e=t.match(/[测京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领]{1}[A-Z]{1}[A-Z0-9]{1,5}[A-Z0-9挂学警港澳]{1}/g);return e?e.join(","):"??"},getDate:function(t){const e=t.match(/(20[0-2]{2}[年/])?[0-9]{1,2}[月/][0-9]{1,2}[号日]*/g);return e?e.join(","):"??"},getMoney:function(t){const e=t.match(/[\w.]+元/g);return e?e.join(","):"??"},uploadAction:function(t,e){console.log(t,e),this.fileList.push(t)},processFile(t,e){const n=new FileReader;n.onload=t=>{const n=t.target.result,l=j.a.read(n,{type:"binary"}),s=l.SheetNames[0],i=l.Sheets[s];e.cols=this.getHeaderRow(i);const o=[],r=j.a.utils.sheet_to_json(i,{header:1});for(let e=1;e<r.length;e++){const t=r[e],n={};for(let e=0;e<t.length;e++)n["column"+e]=t[e]?t[e]+"":"";o.push(n)}e.list=o};const l=t.size/1024/1024;(l<.5||confirm("攀岩志提示: 文件有点大，"+l.toFixed(2)+"M，比较耗时，确认继续么？"))&&n.readAsBinaryString(t.raw)},getHeaderRow:function(t){const e=[],n=j.a.utils.decode_range(t["!ref"]);let l;const s=n.s.r;for(l=n.s.c;l<=n.e.c;++l){const n=t[j.a.utils.encode_cell({c:l,r:s})];let i="UNKNOWN "+l;n&&n.t&&(i=j.a.utils.format_cell(n));const o={id:"column"+l,name:i};e.push(o)}return e}}},z=O,M=(n("29c0"),Object(a["a"])(z,w,k,!1,null,"f430f538",null)),N=M.exports,F=function(){var t=this,e=t._self._c;return e("div",{staticClass:"x-home"},[e("el-upload",{staticClass:"upload-demo",attrs:{multiple:"",action:"","on-change":t.uploadAction,"auto-upload":!1,"file-list":t.fileList}},[e("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")])],1),e("el-divider",{attrs:{"content-position":"left"}},[t._v("操作表格 - 按列分组")]),e("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.previewTables("preview")}}},[t._v("预览表格")]),e("el-input-number",{staticStyle:{margin:"0 20px"},attrs:{label:"按第几列分组",size:"small"},model:{value:t.num,callback:function(e){t.num=e},expression:"num"}}),e("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.exportTable("one")}}},[t._v("导出一个表格")]),e("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.exportTable("more")}}},[t._v("导出多个表格")]),e("el-divider",{attrs:{"content-position":"center"}},[e("el-link",{attrs:{type:"primary",href:"/page/#/?from=操作表格 - 按列分组"}},[t._v("开发者详情")])],1),"preview"===t.index?e("div",{staticStyle:{width:"100%"}},t._l(t.tables,(function(n,l){return e("div",{key:"table-"+l,staticStyle:{width:"100%","margin-right":"8px",float:"left"}},[n.list.length>0?[e("p",{staticStyle:{"font-size":"12px"}},[t._v("共"+t._s(n.list.length)+"条数据 - "+t._s(n.title))]),e("el-table",{attrs:{data:n.list,height:"600px",border:"",stripe:"",size:"small"}},[e("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),t._l(n.cols,(function(t,n){return e("el-table-column",{key:"x-"+n,attrs:{prop:t.id,label:t.name}})}))],2)]:e("p",[t._v("文件解析中...")])],2)})),0):"new"===t.index?e("div",{staticStyle:{width:"100%"}},[e("div",{staticStyle:{width:"100%","margin-right":"8px",float:"left"}},[e("p",{staticStyle:{"font-size":"12px"}},[t._v(t._s(t.result.title))]),e("el-table",{attrs:{data:t.result.list,border:"",stripe:"",size:"small",height:"600px"}},t._l(t.result.cols,(function(t,n){return e("el-table-column",{key:"x-"+n,attrs:{prop:t.id,label:t.name}})})),1)],1)]):t._e()],1)},T=[],A=(n("fef2"),{name:"Home",props:{item:{type:Object,default:function(){return{}}}},data(){return{tables:[],result:{title:"合并后的表格",list:[],cols:[]},fileList:[],index:"xxx",num:8}},methods:{previewTables:function(t){this.index=t,this.tables=[];for(let e=0;e<this.fileList.length;e++){const t=this.fileList[e],n={title:t.name,list:[],cols:[]};this.tables.push(n),this.processFile(t,n)}},createTable:function(t){this.index=t,this.fileList.length<3&&alert("应该是三个表格");for(let e=0;e<this.tables[2].list.length;e++){const t=this.tables[2].list[e];let n=null,l=null;for(let e=0;e<this.tables[1].list.length;e++){const l=this.tables[1].list[e],s=Object.keys(l);for(let e=0;e<s.length;e++){const i=s[e];l[i]+""===t.column0+""&&(n=l)}}for(let e=0;e<this.tables[0].list.length;e++){const n=this.tables[0].list[e],s=Object.keys(n);for(let e=0;e<s.length;e++){const i=s[e];n[i]+""===t.column2+""&&(l=n)}}t&&n&&l?console.log(t,n,l):console.log("不合法")}},exportTable:function(t="one"){const e=this.tables[0].list,n={};for(let i=0;i<this.tables[0].cols.length;i++){const t=this.tables[0].cols[i];n[t.id]=t.name}const l=[],s="column"+(this.num-1);for(let i=0;i<e.length;i++){const t=e[i],o=l.find(e=>e.name===t[s]);if(o)console.log("已存在",t[s]);else{const i={name:t[s],list:e.filter(e=>e[s]===t[s])};i.list.unshift(n),l.push(i)}}if("one"===t){const t=j.a.utils.book_new();for(let e=0;e<l.length;e++){const n=l[e];if(n.list.length){console.log("组:",e,n.name);const l=n.list[0],s=Object.keys(l),i=j.a.utils.json_to_sheet(n.list,{skipHeader:!0});i["!cols"]=[];for(let t=0;t<s.length;t++){const e=s[t];l[e]?i["!cols"].push({wch:2*(l[e]+"").length+10}):i["!cols"].push({wch:10})}j.a.utils.book_append_sheet(t,i,n.name)}}j.a.writeFile(t,"分组后.xlsx")}else if(confirm("攀岩志提示: 一共将的导出"+l.length+"个表格, 下载大概需要用时"+1.5*l.length/60+"min，确定下载？"))for(let i=0;i<l.length;i++)setTimeout(function(t){return function(){const e=l[t];if(e.list.length){console.log("组:",t,e.name);const n=j.a.utils.book_new(),l=e.list[0],s=Object.keys(l),i=j.a.utils.json_to_sheet(e.list,{skipHeader:!0});i["!cols"]=[];for(let t=0;t<s.length;t++){const e=s[t];l[e]?i["!cols"].push({wch:2*(l[e]+"").length+10}):i["!cols"].push({wch:10})}setTimeout(()=>{const l=e.name&&e.name.length>0?e.name:"空分组信息"+t;j.a.utils.book_append_sheet(n,i,l),j.a.writeFile(n,l+".xlsx")},5e3)}}}(i),1e3*i)},getGroups:function(t,e){var n={};t.forEach(t=>{if(n[t[e]])n[t[e]].list.push(t);else{const l={list:[t]};l[e]=t[e],n[t[e]]=l}});const l=[];for(var s in n)l.push(n[s]);return l},uploadAction:function(t,e){console.log(t,e),this.fileList.push(t)},processFile(t,e){const n=new FileReader;n.onload=t=>{const n=t.target.result,l=j.a.read(n,{type:"binary"}),s=l.SheetNames[0],i=l.Sheets[s];e.cols=this.getHeaderRow(i);const o=[],r=j.a.utils.sheet_to_json(i,{header:1});for(let e=1;e<r.length;e++){const t=r[e],n={};for(let e=0;e<t.length;e++)n["column"+e]=t[e]?t[e]+"":"";o.push(n)}e.list=o};const l=t.size/1024/1024;(l<.5||confirm("攀岩志提示: 文件有点大，"+l.toFixed(2)+"M，比较耗时，确认继续么？"))&&n.readAsBinaryString(t.raw)},getHeaderRow:function(t){const e=[],n=j.a.utils.decode_range(t["!ref"]);let l;const s=n.s.r;for(l=n.s.c;l<=n.e.c;++l){const n=t[j.a.utils.encode_cell({c:l,r:s})];let i="UNKNOWN "+l;n&&n.t&&(i=j.a.utils.format_cell(n));const o={id:"column"+l,name:i};e.push(o)}return e}}}),C=A,L=(n("1cb5"),Object(a["a"])(C,F,T,!1,null,"52440e32",null)),H=L.exports;l["default"].use(m["a"]);const B=new m["a"]({routes:[{path:"/",component:x,name:"Home",meta:{title:"交流与合作"}},{path:"/excel/group",name:"GroupHome",component:H,meta:{title:"表格按列分组"}},{path:"/excel/car/number",name:"CarNumber",component:N,meta:{title:"表格提取车牌号"}}]});B.beforeEach((t,e,n)=>{t.meta.title&&(document.title="攀岩志团队 - "+t.meta.title),n()});const P=m["a"].prototype.push;m["a"].prototype.push=function(t){return P.call(this,t).catch(t=>t)};var $=B,D=n("23c5"),R=n.n(D);l["default"].config.productionTip=!1,l["default"].use(R.a),l["default"].prototype.changeValue=function(t){return t.target.value},new l["default"]({render:t=>t(u),router:$,store:d}).$mount("#app")},a81b:function(t,e,n){},bcc3:function(t,e,n){t.exports=n.p+"img/qiyewechat.d034548f.png"},c21b:function(t,e,n){"use strict";n("e925")},e925:function(t,e,n){},fa37:function(t,e,n){"use strict";n("a81b")}});
//# sourceMappingURL=app.d208093f.js.map